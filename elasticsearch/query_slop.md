# slop

## 查询：「上大学」这个词

### 1.「上大学」分词结果：

|序号|词|
|---|---|
|1|上|
|2|大学|

### 2.期望的查询结果

优先把包含完整 「上大学」词组的句子放到搜索结果的最前面（即它们的搜索得分最高），其它的搜索结果依次放在后面。

比如，搜索结果：

| 序号      | 句子 | 备注 |
| ----------- | ----------- | ----------- |
|1|我们去`上大学`了。| 完整词 |
|2|本专题特为您讲述了`上大学`需要做好的那些准备。| 完整词 |
|3|我`上大学`的时候很喜欢听音乐。| 完整词 |
|4|`上`了`大学`很多人都很迷茫。| 非完整词 |
|5|认为只有`上`了`大学`才会有出息。| 非完整词 |
|6|你要大大超过那些没`上`过`大学`的人。| 非完整词 |
|7|竟然考`上`了`大学`本科。| 非完整词 |

### 2.分析

由于「上大学」这个词组会分词为「上」、「大学」两个词，所以，我们将 `slop` 设置成 0，表示它们的 offset 间隔为 0 时，视作一个有效词语对待。也即是表示将他们看成一个完整词。

同时，我们使用 「should」将 「上大学」 提高搜索得分，也即是：

一个文档不必必须的包含完整的「上大学」这个词组，但是如果一旦包含了，ES 就会认为这个它们「更相关」。

```json
{
    "from": 0,
    "size": 200,
    "query": {
        "bool": {
            "must": [{
                "match": {
                    "school": "上大学"
                }
            }],
            "should": {
                "match_phrase": {
                    "school": {
                        "query": "上大学",
                        "slop": 0
                    }
                }
            }
        }
    },
    "fields": [
        "school"
    ]
}
```