# Rabbitmq 高可用之分区处理策略

### 策略分类

+ **pause_minority**
    + 使用场景：
        + 应用于网络环境没有那么可靠的场景
    + 能否自动恢复？
        + 失效节点恢复后，节点自动加入集群
    + 最佳工作节点数：
        + 奇数节点，比如 3 个
        + 禁忌拥有 2 个节点的集群使用这个模式
            + 如果有 2 个节点，他们发生了分区，那么，由于每个分区节点数都不足半数，所以，这2个节点都将停止
    + 恢复策略：
        + 停掉满足下列条件的分区
            + 分区节点数 <= 整个集群节点数
        + 将上述分区节点停止，并在恢复后重新启动
+ **autoheal**
    + 使用场景：
        + 应用于网络环境可能是不可靠的
    + 能否自动恢复？
        + 重启失效分区节点，节点自动加入集群？
    + 恢复策略：
        + 选择客户的连接数最多的分区作为主分区，如果连接数相同，选择拥有节点数最多的分区作为主分区，否则，随机选择一个分区
    + 最佳工作节点数：
        + 没有特殊要求？
+ **ignore**
    + 使用场景：
        + 应用于网络环境非常可靠的场景
    + 能否自动恢复？
        + 发生分区后，所有的节点仍处于运行状态，所以，不存在恢复过程
    + 恢复策略
        + 不存在恢复过程，节点仍然运行中
    + 最佳工作节点数
        + 无特殊要求
+ **pause_if_all_down**
    +  使用场景
        + 发生分区后，只要无法与给出的 node列表中的节点通信，节点都将被停止
            + 当然，也可能存在这个 node 列表中的节点已经停止运行了，那么，所有分区都将存活
        + 偶数个节点，并且平均分配在多个机房中
            + 与 pause_minority 相比，由于不会收到类似半数节点数这样的限制，所以，能够最终保证有分区存活
    +  能否自动恢复？
        +  
    +  恢复策略
        +  
    +  最佳工作节点数